let locations=[
    {
        name:"Badrinath",
        desc:"Journey from Dehradun to Badrinath: from Himalayan tranquility to the vibrant energy of India's capital.",
        time:"7",
        distance:"251",
        image:"../Images/top-section-2-img-3.avif",
    },
    {
        name:"Kedarnath",
        desc:"Experience the scenic journey from bustling Dehradun to the serene, tranquil hills of Kedarnath.",
        time:"7",
        distance:"324",
        image:"../Images/top-section-2-img-2.jpg",
    },
    {
        name:"Nainital",
        desc:"Travel from Dehradun to Nainital by car, enjoying coastal beauty and scenic Western Ghats along the way.",
        time:"6",
        distance:"493",
        image:"../Images/top-section-2-img-1.cms",
    },
    {
        name:"Gangotri",
        desc:"The journey from Dehradun to Gangotri offers stunning views of the Garhwal Himalayas and sacred landscapes.",
        time:"6",
        distance:"224",
        image:"../Images/top-section-2-img-4.jpg",
    },
    {
        name:"Yamunotri",
        desc:"The journey from Dehradun to Yamunotri offers a picturesque route through the scenic beauty of the Garhwal Himalayas.",
        time:"5",
        distance:"124",
        image:"../Images/top-section-2-img-5.webp",
    },
    {
        name:"Uttarkashi",
        desc:"Uttarkashi is a Hindu religious place for spiritual and adventurous tourism. Uttarkashi town is also called as Shivnagri.",
        time:"4",
        distance:"144",
        image:"../Images/top-section-2-img-6.jpg",
    },
    {
        name:"Rishikesh",
        desc:"Rishikesh is a city in India’s northern state of Uttarakhand, in the Himalayan foothills beside the Ganges River",
        time:"1",
        distance:"38",
        image:"../Images/top-section-2-img-7.avif",
    },
    {
        name:"Mussorie",
        desc:"Mussoorie is a hill station and a municipal board, in Dehradun city in the Dehradun district of the Indian state Uttarakhand",
        time:"2",
        distance:"40",
        image:"../Images/top-section-2-img-8.jpg",
    },
    {
        name:"Chamoli",
        desc:"Chamoli hosts a variety of destinations of pilgrim and tourist interest including Badrinath, Hemkund Sahib and Valley of Flowers.",
        time:"8",
        distance:"264",
        image:"../Images/top-section-2-img-9.webp",
    },
];


let cars1=[
    {
        carName:"Maruti Suzuki Wagon R",
        carCategory:"Business",
        carDesc:"The Maruti Suzuki Wagon R is a popular tallboy hatchback offering a spacious and practical interior, making it a favorite among small families. Known for its reliability and fuel efficiency, it comes with a choice of peppy engines and advanced safety features.",
        carPrice:"15",
        carDiscount:"12",
        carCapacity:"5-seater",
        carAirbags:"Dual front airbags",
        carFeatures:"Suzuki Connect, ABS with EBD, Heartect platform",
        carImage:"../Images/wagonR.webp",
        locationName:"Badrinath",
        locationDesc:"Journey from Dehradun to Badrinath: from Himalayan tranquility to the vibrant energy of India's capital.",
        locationTime:"7",
        locationDistance:"251",
        locationImage:"../Images/top-section-2-img-3.avif",
    },
    {
        carName:"Nissan Caravan 4WD",
        carCategory:"MiniVan",
        carDesc:"The Nissan Caravan 4WD is a rugged and versatile van built for off-road adventures and challenging terrain. With its four-wheel-drive capability, spacious interior, and robust construction, it offers reliable performance and ample cargo space, making it ideal for outdoor enthusiasts and commercial use in various environments.",
        carPrice:"80",
        carDiscount:"75",
        carCapacity:"6-seater",
        carAirbags:"Dual front airbags (standard)",
        carFeatures:"The Nissan Caravan 4WD is a rugged and versatile van built for off-road adventures and challenging terrain. With its four-wheel-drive capability, spacious interior, and robust construction, it offers reliable performance and ample cargo space, making it ideal for outdoor enthusiasts and commercial use in various environments.",
        carImage:"../Images/caravan.png",
        locationName:"Kedarnath",
        locationDesc:"Experience the scenic journey from bustling Dehradun to the serene, tranquil hills of Kedarnath.",
        locationTime:"7",
        locationDistance:"324",
        locationImage:"../Images/top-section-2-img-2.jpg",
    },
    {
        carName:"Maruti Suzuki Ertiga",
        carCategory:"SUV",
        carDesc:"The Maruti Suzuki Ertiga is a popular MPV that combines practicality with affordability, offering a spacious interior suitable for families. It features efficient engine options, modern infotainment, and safety features, providing a comfortable and reliable ride for urban and long-distance travel.",
        carPrice:"42",
        carDiscount:"39",
        carCapacity:"7-seater",
        carAirbags:"Dual front airbags (standard)",
        carFeatures:"SmartPlay infotainment system, Android Auto and Apple CarPlay support, ABS with EBD, ISOFIX child seat mounts",
        carImage:"../Images/ertiga.webp",
        locationName:"Gangotri",
        locationDesc:"The journey from Dehradun to Gangotri offers stunning views of the Garhwal Himalayas and sacred landscapes.",
        locationTime:"6",
        locationDistance:"224",
        locationImage:"../Images/top-section-2-img-4.jpg",
    },
    {
        carName:"Force Traveller 3350 Van",
        carCategory:"Van",
        carDesc:"The Force Traveller 3350 Van is a reliable and spacious commercial vehicle designed for passenger transportation. With its sturdy build, comfortable seating, and ample luggage space, it provides a comfortable and safe travel experience for both short and long journeys, making it a preferred choice for businesses, tour operators, and transportation services.",
        carPrice:"98",
        carDiscount:"85",
        carCapacity:"12 to 26-seater options",
        carAirbags:"Not typically equipped",
        carFeatures:"Spacious interior, customizable seating configurations, durable build for commercial use",
        carImage:"../Images/force.jpg",
        locationName:"Yamunotri",
        locationDesc:"The journey from Dehradun to Yamunotri offers a picturesque route through the scenic beauty of the Garhwal Himalayas.",
        locationTime:"5",
        locationDistance:"124",
        locationImage:"../Images/top-section-2-img-5.webp",
    },
]

let cars2=[
    {
        carName:"Volkswagen Camper",
        carCategory:"Van",
        carDesc:"The Volkswagen Camper, also known as the VW Bus or Transporter, is an iconic camper van celebrated for its timeless design and practicality. Renowned for its versatility, it offers a comfortable living space with sleeping quarters, kitchen amenities, and ample storage, making it a beloved choice for road trips and outdoor adventures.",
        carPrice:"108",
        carDiscount:"100",
        carCapacity:"Varies based on model and layout (typically 4-5 people)",
        carAirbags:"Dependent on model and year",
        carFeatures:"Convertible living space, kitchen amenities, ample storage",
        carImage:"../Images/camper.jpg",
        locationName:"Rishikesh",
        locationDesc:"Rishikesh is a city in India’s northern state of Uttarakhand, in the Himalayan foothills beside the Ganges River",
        locationTime:"1",
        locationDistance:"38",
        locationImage:"../Images/top-section-2-img-7.avif",
    },
    {
        carName:"Toyota Innova Crysta",
        carCategory:"SUV",
        carDesc:"The Toyota Innova Crysta is a premium MPV renowned for its robust build quality, spacious and luxurious interior, and powerful engine options. It offers a comfortable ride with advanced safety features and modern infotainment systems, making it a preferred choice for families and long-distance travelers.",
        carPrice:"45",
        carDiscount:"42",
        carCapacity:"7-seater or 8-seater options",
        carAirbags:"Dual front airbags (standard), up to 7 airbags available in higher variants",
        carFeatures:"Touchscreen infotainment system, automatic climate control, ABS with EBD, Vehicle Stability Control (VSC)",
        carImage:"../Images/crysta.webp",
        locationName:"Chamoli",
        locationDesc:"Chamoli hosts a variety of destinations of pilgrim and tourist interest including Badrinath, Hemkund Sahib and Valley of Flowers.",
        locationTime:"8",
        locationDistance:"264",
        locationImage:"../Images/top-section-2-img-9.webp",
    },
    {
        carName:"Maruti Suzuki Celerio",
        carCategory:"Business",
        carDesc:"The Maruti Suzuki Celerio is a compact hatchback known for its fuel efficiency and practical design, making it an ideal choice for urban commuting. It features a spacious interior, user-friendly technology, and the option of an AMT gearbox for added convenience.",
        carPrice:"10",
        carDiscount:"8",
        carCapacity:"5-seater",
        carAirbags:"Dual front airbags",
        carFeatures:"Suzuki Connect, ABS with EBD, Heartect platform",
        carImage:"../Images/celerio.webp",
        locationName:"Nainital",
        locationDesc:"Travel from Dehradun to Nainital by car, enjoying coastal beauty and scenic Western Ghats along the way.",
        locationTime:"6",
        locationDistance:"493",
        locationImage:"../Images/top-section-2-img-1.cms",
    },
    {
        carName:"Mercedes R63 AMG",
        carCategory:"MiniVan",
        carDesc:"The Mercedes R63 AMG is a rare and high-performance luxury SUV that combines Mercedes-Benz's renowned comfort and refinement with AMG's performance prowess. Powered by a potent V8 engine, it offers exceptional acceleration and handling for an SUV of its size, making it a standout choice for those seeking a blend of luxury, practicality, and thrilling driving dynamics.",
        carPrice:"86",
        carDiscount:"84",
        carCapacity:"7-seater",
        carAirbags:"Front, side, and curtain airbags",
        carFeatures:"AMG-tuned V8 engine, luxurious interior, advanced safety systems",
        carImage:"../Images/amg.jpg",
        locationName:"Mussorie",
        locationDesc:"Mussoorie is a hill station and a municipal board, in Dehradun city in the Dehradun district of the Indian state Uttarakhand",
        locationTime:"2",
        locationDistance:"40",
        locationImage:"../Images/top-section-2-img-8.jpg",
    },
]

function displayData(data){
    let parentDiv=document.querySelector("#best");
    parentDiv.innerHTML="";

    data.forEach((car,i)=>{

        const carDiv = document.createElement('div');
        carDiv.className='child-cars';

        carDiv.innerHTML = `
        <div class="single pointer">
            <img src="${car.carImage}" alt="">
        </div>
        <div>
            <h1>${car.carName}</h1>
            <p><span>Category: </span>${car.carCategory}</p>
            <p><span>Location:</span> Dehradun To ${car.locationName}</p>
            <div class="price"><span>₹${car.carPrice}/km</span><span>₹${car.carDiscount}/km</span></div>
            <button class="book-now pointer">BOOK NOW</button>
        </div>
        `;
        carDiv.querySelector(".single").addEventListener("click", () => handleSingle(car));
        carDiv.querySelector(".book-now").addEventListener("click", () => handleBook(car));

        parentDiv.appendChild(carDiv);
    });
}
displayData(cars1);

function displayData1(data){
    let parentDiv=document.querySelector("#summer");
    parentDiv.innerHTML="";

    data.forEach((car,i)=>{

        const carDiv = document.createElement('div');
        carDiv.className='child-cars';

        carDiv.innerHTML = `
        <div class="single1 pointer">
            <img src="${car.carImage}" alt="">
        </div>
        <div>
            <h1>${car.carName}</h1>
            <p><span>Category: </span>${car.carCategory}</p>
            <p><span>Location:</span> Dehradun To ${car.locationName}</p>
            <div class="price"><span>₹${car.carPrice}/km</span><span>₹${car.carDiscount}/km</span></div>
            <button class="book-now1 pointer">BOOK NOW</button>
        </div>
        `;
        
        carDiv.querySelector(".single1").addEventListener("click", () => handleSingle(car));
        carDiv.querySelector(".book-now1").addEventListener("click", () => handleBook(car));

        parentDiv.appendChild(carDiv);
    });
}
displayData1(cars2);

function handleSingle(car){
    localStorage.removeItem("single");
    let obj={
        airbags:car.carAirbags,
        capacity:car.carCapacity,
        category:car.carCategory,
        desc:car.carDesc,
        features:car.carFeatures,
        image:car.carImage,
        name:car.carName,
        price:car.carPrice,
    }
    localStorage.setItem("single",JSON.stringify(obj));
    window.location.href='./single-card.html';
}

function handleBook(car){
    let userLog=JSON.parse(localStorage.getItem("userLog"));
    if(userLog){
        localStorage.removeItem("car");
        let obj={
            airbags:car.carAirbags,
            capacity:car.carCapacity,
            category:car.carCategory,
            desc:car.carDesc,
            features:car.carFeatures,
            image:car.carImage,
            name:car.carName,
            price:car.carPrice,
        }
        localStorage.setItem("car",JSON.stringify(obj));
        localStorage.removeItem("location");
        let obj1={
            desc:car.locationDesc,
            distance:car.locationDistance,
            image:car.locationImage,
            name:car.locationName,
            time:car.locationTime,
        }
        localStorage.setItem("location",JSON.stringify(obj1));
        window.location.href='./checkout.html';
    }
    else{
        window.location.href='./login.html';
    }
    
}

//Local storage Update
let historyData = JSON.parse(localStorage.getItem("history")) || [];
let userLog = JSON.parse(localStorage.getItem("userLog")) || [];

if(userLog?.email?.length!=0) {
    let currentDate = new Date();
    let day = currentDate.getDate();
    let month = currentDate.getMonth() + 1;
    let year = currentDate.getFullYear();

    let userHistory = historyData.filter(entry => {
        let date=entry.bookingDate.split("-");
        return entry.email === userLog.email && (year<date[2] || month<date[1] || day<=date[0]) && entry.status!="cancel" && entry.status!="completed";
    });
    localStorage.setItem("user-booking", JSON.stringify(userHistory));
}

//Badge update
let userBooking=JSON.parse(localStorage.getItem("user-booking")) || [];
let bookCount=document.getElementById("book-count");
bookCount.innerText="";
bookCount.innerText=userBooking.length;

//UserLog
if(userLog && userLog.length!=0){
    let nameEle = document.getElementById("name");
    nameEle.textContent=userLog.name.toUpperCase();
    nameEle.removeAttribute("href");

    let logEle = document.getElementById("log");
    logEle.removeAttribute("href");
    logEle.textContent = "Logout";

    logEle.addEventListener("click",function(){
        localStorage.removeItem("userLog");
        window.location = "../index.html";
    });
}

//Search bar nav
let searchInput = document.getElementById("search-input");
let searchIcon = document.getElementById("search-icon");
let searchResult = document.getElementById("search-result");

searchInput.addEventListener("input", () => {
    const query = searchInput.value;
    if(query.length==0){
        searchResult.style.display="none";
    }else{
        searchResult.style.display="block";
    }
    const results = filterLocations(query);
    searchInput.style.display="block";
    displayResults(results);
});

searchIcon.addEventListener("click", () => {
    const query = searchInput.value;
    const results = filterLocations(query);
    searchInput.style.display="block";  
    displayResults(results);
});

function filterLocations(query) {
    return locations.filter(location => location.name.toLowerCase().includes(query.toLowerCase()));
}

function displayResults(results) {
    searchResult.innerHTML = "";
    if(results.length == 0) {
        searchResult.innerHTML = "<p>No results found</p>";
    }
    results.forEach(location => {
        let div=document.createElement("div");
        div.className="outer";
        div.innerHTML=`
            <div class="inner-img">
                <img src="${location.image}">
            </div>
            <div class="inner-text">
                <p><span>Name:</span> ${location.name}</p>
                <p><span>Distance:</span> ${location.distance}</p>
            </div>
        `;

        div.addEventListener("click",()=>handleSearch(location));

        searchResult.appendChild(div);
    });
}

function handleSearch(location){
    let userLog=JSON.parse(localStorage.getItem("userLog"));
    if(userLog){
        localStorage.removeItem("location");
        localStorage.setItem("location",JSON.stringify(location));
        window.location.href='./cars-card.html';
    }
    else{
        window.location.href='./login.html';
    }
}

//admin log
let adminLog = JSON.parse(localStorage.getItem("adminLog"));

let admin = document.getElementById("admin");
admin.addEventListener("click",handleAdmin);

function handleAdmin(){
    if(adminLog && adminLog.length != 0){
        window.location.href="./admin-dashboard.html"
    }
    else{
        window.location.href="./admin-login.html"
    }   
}